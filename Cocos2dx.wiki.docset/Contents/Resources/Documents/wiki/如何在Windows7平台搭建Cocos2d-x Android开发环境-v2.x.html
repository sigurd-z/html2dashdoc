<html><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>如何在Windows 7平台搭建Cocos2d-x Android开发环境_Cocos帮助文档_Cocos引擎_游戏开发引擎_Cocos引擎官网</title>
<meta content="IE=8" http-equiv="X-UA-Compatible">
<meta content="Cocos帮助文档,Cocos2d-x文档,Cocos2d-JS文档,Cocos Code IDE文档,Quick-Cocos2d-x文档,Cocos API,Cocos,Cocos引擎,Cocos介绍,Cocos文档,Cocos特点,Cocos引擎下载,Cocos官网,游戏引擎,游戏引擎下载,游戏开发引擎,html5游戏开发,Android游戏开发,ios游戏开发,游戏开发方案,游戏开发工具" name="keywords"/>
<meta content="Cocos提供了全套的引擎和开发工具,涵盖从前期设计,资源制作,开发调试,打包上线全套的解决方案,Cocos重点优化了工作流,规范了整个游戏开发流程,降低沟通成本,提高开发效率" name="description"/>
<link href="src/2ef9a86fb35d52ac11578452ccf1485f.css" rel="stylesheet" type="text/css"/>
<link href="src/88a5440cf79e2c8f05f9f10ce6aba841.css" rel="stylesheet" type="text/css"/>
<link href="src/aade560970aa998972e368caf1c78181.css" rel="stylesheet" type="text/css"/>
<script src="src/07bd722c9fad66b606a50c3acc1af50f.js" type="text/javascript"></script>
<script src="src/de92148ebc93b342e9b5b8f21d7fe69c.js" type="text/javascript"></script>
<script src="https://passport.cocos.com/sso/get_sso_header?client_id=161" type="text/javascript"></script>
<script src="src/bd48e73433c4825b90f3554d64a5ae4f.js" type="text/javascript"></script>
</meta></head><body style="padding:0 25px;"><div class="itemdoc">
<h1>如何在Windows 7平台搭建Cocos2d-x Android开发环境</h1>
<p><strong>注意：</strong>本指南主要以Cocos2d-x 2.x版本引擎为例。因为Cocos2d-x 3.x引擎不需要安装cygwin即可编译Android样本程序，欲了解更多信息可参见本贴。</p>
<p>在Windows 7平台搭建Android Cocos2d-x开发环境不难，但因为框架更新频繁，许多用户在使用过程中还是会遇到很多问题。希望本指南对用户有好处。</p>
<p><strong>建议：</strong>为避免安全相关问题，所有操作请在管理员身份下进行，在运行命令时，请确保以管理员身份打开控制台（console）。    <br/>
本指南将介绍如何在Windows 7平台搭建Cocos2d-x Android开发环境。本指南操作要求一台搭载Windows 7平台及安装Visual Studio 2010的电脑。最好拥有快速稳定的网络，因为在指南操作中需要下载许多软件包。</p>
<h3>下载Cocos2d-x 2.2引擎</h3>
<p><strong>注意：</strong>目前最新版本的引擎为Cocos2d-x 2.2。   <br/>
用户可以登陆<a href="http://www.cocos2d-x.org/">Cocos2d-x</a> 官方网站下载最新稳定版的Cocos2d-x。如图所示。  </p>
<p><img alt="" src="src/4f2a7ec1b7718dfef734a583b8063890.jpeg"/></p>
<p>点击导航栏的“Download”（下载）后你会看到如下下载页面：</p>
<p><img alt="" src="src/e8edc2c875407a52643855125fde9a1b.jpeg"/></p>
<p>从图中可以看出，官网有两个版本可供下载，一个为Cocos2d-x 2.2，另一个为Cocos2d-x 3.0 pre-alpha0。</p>
<p>在本指南中，将会以Cocos2d-x 2.2为例。
（注意：如果你想要下载旧版的Cocos2d-x，可点击“looking for an old versoin?”链接。但本人强烈推荐使用最新版本的Cocos2d-x，新版引擎有很多新功能，修复了旧版的很多问题。）</p>
<p>右键单击“Download”链接选择“save link as…”（将链接保存为…），然后将压缩文件保存至适当的位置。本机保存位置为C:\cocos2d-x-2.2.0.。    </p>
<p>（更新：请不要将cocos2d-x文件夹放置c:\下，因为会导致很多优先级别（privilege）相关的问题。可尝试将该文件夹放到其他盘如D:\及E:\等等。）</p>
<p><img alt="" src="src/9d482fbc4834cb68f678e29ce98338c7.jpeg"/></p>
<h3>Cocos2d-x新手入门</h3>
<p>看到上图红色划线部分了吗？双击这个名为“cocos2d-win32.vs2010.sln”的文件，然后会自动启动Visual Studio 2010。
现在你便可以将HelloCpp项目当作默认启动项目来编译，按CTRL-F5运行样本程序。如果编译没有什么错误，同时运行成功的话，你会看到如下画面。</p>
<p><img alt="" src="src/57d41fd0019a8031cbf201d562e6632c.jpeg"/></p>
<p>祝贺你！你已成功在Windows 7平台中运行Cocos2d-x引擎。接下里介绍如何配置Android开发环境。</p>
<h3>配置Android开发环境</h3>
<p>因为我们是针对Android开发，所以我们需要安装的第一个软件包绝对是JDK。如果你用的是64位的Windows 7，那应该下载以下版本软件64 bit JDK for windows 64bit，当前最新64位Windows 7版本的JDK为jdk-7u45-windows-x64.exe。
下载完成之后，安装JDK。安装完成之后，最好设置一个名为“JAVA_HOME”的环境变量，在本机为：C:\Program Files\Java\jdk1.7.0_45。</p>
<p>（(注意：如果在设置环境变量过程中遇到问题，请参考本帖寻求帮助。）
现在请下载Android SDK。Android SDK包括以下应用，这些均用于开发Android应用。</p>
<ul>
<li>Eclipse + ADT插件</li>
<li>Android SDK Tools</li>
<li>Android Platform-tools</li>
<li>最新Android平台</li>
<li>用于模拟器的最新Android系统镜像</li>
</ul>
<p>下载Android SDK大概需要几分钟时间，主要看用户的网络速度。下载之后解压，并将其放置于C:\adt-bundle-windows-x86_64目录下。在C:\adt-bundle-windows-x86_64\eclipse文件夹中会有一个eclipse.exe程序，本机在桌面上创建了该程序的快捷方式。</p>
<p>现在用户可以双击桌面的快捷方式启动Eclipse，同时会出现一个即时对话框，要求设置默认工作区（workspace）。选择“OK”接受默认设置即可。</p>
<p>在导入样本Android项目之前，需要设置一个名为“ANDROID_SDK”新的环境变量，将其值设为“C:\adt-bundle-windows-x86_64\sdk”。</p>
<p>接下来要安装cygwin。本机安装路径为C:\cygwin64\bin。下载之后请用cygwin安装以下软件包。
1autoconf, automake, binutils, gcc-core, gcc-g++, gcc4-core, gcc4-g++, gdb, pcre, pcre-devel, gawk, make</p>
<p>现在请将cygwin的bin文件夹添加到系统PATH路径后面。本机还在系统路径后面添加了Android平台工具。本机的PATH环境变量如下所示：
1C:\cygwin64\bin;C:\adt-bundle-windows-x86_64\sdk\platform-tools;C:\adt-bundle-windows-x86_64\sdk\tools;</p>
<p>安装完成之后，还要安装“Android NDK”软件包，用户可前往下载链接。下载完成之后，解压，并将其放置到C:\android-ndk-r9路径，设置另一个名为“NDK_ROOT”同时指向url的环境变量。</p>
<p>最后便可启动Eclipse然后导入cocos2d-x文件夹中的样本Android项目。操作步骤如下：</p>
<ul>
<li>右键点击“Package Explorer”并选择“Import…”</li>
<li>当出现对话框时，选择“Exsiting Android project into workspace”（将现有Android项目导入工作区）。</li>
</ul>
<p><img alt="" src="src/04f270a5fd452e22b89e161066f6e1dc.jpg"/></p>
<p>现在选择C:\cocos2d-x-2.2.0\samples\Cpp\HelloCpp\proj.android为导入文件夹，之后便会看到如下画面。</p>
<p><img alt="" src="src/c632f6ebbf1bd8654a92b2bb70ec207d.jpg"/></p>
<p>你可能会到如图所示红线部分“Package Explorer”的错误：</p>
<p><img alt="" src="src/39d9f765bed3e46f3ea7af27807c8fd2.jpg"/></p>
<p>这是因为缺少Cocos2d-x Android JNI桥接库（bridge library）。解决方法：导入另一个Android项目，项目位置为“C:\cocos2d-x-2.2.0\cocos2dx\platform\android”。导入项目之后，错误即会消失，如下图所示。</p>
<p><img alt="" src="src/cb1c8cab851f4800106ac7dfa0900588.jpg"/></p>
<h3>测试Cocos2d-x Android NDK环境</h3>
<p>这次将切换使用终端，而不是Windows CMD命令工具。打开目录“c:\cygwin64”，双击“Cygwin.bat”文件。这是会出现一个终端，你可以使用bash命令来定位Cocos2d-x Android项目。</p>
<p>操作如下：    </p>
<pre><code>cd /cygdrive/c/cocos2d-x-2.2.0/samples/Cpp/HelloCpp/proj.android/</code></pre>
<p>再执行以下命令：    </p>
<p><code>1./build_native.sh</code></p>
<p>如果没有错误出现，那恭喜你，Windows 7平台Cocos2d-x Android开发环境已经正在运行。</p>
<p>（注意：你也可以通过Eclipse来运行Android应用。右键单击Android项目然后选择“Run as Android Application”即可。）</p>
<h3>在Android手机安装APK应用</h3>
<p>用户可使用如下命令在Android手机中安装HelloCpp.apk应用：</p>
<pre><code>adb install  bin/HelloCpp.apk</code></pre>
<p>（注意：如果上述操作失败，请对环境进行配置，参见以下疑难解答部分。）</p>
<h3>疑难解答</h3>
<ul>
<li>
<p>若出现“The Android AndroidManifest.xml is missing”错误，请参考解决方案。</p>
</li>
<li>
<p>若出现“Android requires compiler compliance level 5.0 or 6.0. Found ‘1.7’ instead.”错误，请参考解决方案。</p>
</li>
<li>
<p>若出现“Unable to add ‘C:\cocos2d-x-2.2.0\samples\Cpp\HelloCpp\proj.android\assets\fonts\Marker Felt.ttf’: Zip add failed.”错误，请参考解决方案。类似问题包括“无法添加xxx.png文件”，解决方法是在cygwin环境中使用chmod命令改变文件的访问控制。（更新：你可以以管理员身份运行Eclipse然后权限问题便会解决。）</p>
</li>
<li>
<p>有时候出现的问题的确很奇怪，这时建议关闭“Build automatically”（自动编译）选项，清除所有项目，然后重新编译工作区。有时甚至需要重启Eclipse然后不断重复以上步骤。在Windows平台进行Android NDK开发有时真的很垃圾！</p>
</li>
<li>
<p>如果Eclipse无法工作，你可以尝试使用命令行工具。解决方案如下：首先在“PATH”环境变量末尾增加“ant”编译命令。变量值为“C:\adt-bundle-windows-x86_64\eclipse\plugins\org.apache.ant_1.8.3.v201301120609\bin”。然后参考本帖编译并将APK安装至你的手机。</p>
</li>
<li>“Android Dependencies”问题如下图所示：</li>
</ul>
<p><img alt="" src="src/b64b07f834772e6c6fd98aa777386f90.jpg"/></p>
<p>解决方法是打开项目的“Build…path”选项，然后选择“Configure build path”，然后选择“Library”，移除出现问题的库依赖（library dependency）</p>
<p>如果在配置过程中遇到问题，请告知我们，我们会竭力为你解答并更新本指南。</p>
</div></body></html>
<html><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# object: http://ogp.me/ns/object# article: http://ogp.me/ns/article# profile: http://ogp.me/ns/profile#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="en" http-equiv="Content-Language">
<meta content="width=1020" name="viewport">
<title>lordofpomelo 0.3新特性 · NetEase/pomelo Wiki · GitHub</title>
<link href="/opensearch.xml" rel="search" title="GitHub" type="application/opensearchdescription+xml">
<link href="src/ad667adaa2cfe8f3caa4a41b7d0a79a1.png" rel="fluid-icon" title="GitHub">
<link href="src/a10d19ff5f738940a7a5086be334f50b.png" rel="apple-touch-icon" sizes="57x57">
<link href="src/a10d19ff5f738940a7a5086be334f50b.png" rel="apple-touch-icon" sizes="114x114">
<link href="src/b4cd268bc600cc14d2cdd557de6da2fb.png" rel="apple-touch-icon" sizes="72x72">
<link href="src/b4cd268bc600cc14d2cdd557de6da2fb.png" rel="apple-touch-icon" sizes="144x144">
<meta content="1401488693436528" property="fb:app_id">
<meta content="@github" name="twitter:site"/><meta content="summary" name="twitter:card"/><meta content="NetEase/pomelo" name="twitter:title"/><meta content="pomelo - A fast,scalable,distributed game server framework for Node.js." name="twitter:description"/><meta content="https://avatars0.githubusercontent.com/u/1460597?v=3&amp;s=400" name="twitter:image:src"/>
<meta content="GitHub" property="og:site_name"/><meta content="object" property="og:type"/><meta content="https://avatars0.githubusercontent.com/u/1460597?v=3&amp;s=400" property="og:image"/><meta content="NetEase/pomelo" property="og:title"/><meta content="https://github.com/NetEase/pomelo" property="og:url"/><meta content="pomelo - A fast,scalable,distributed game server framework for Node.js." property="og:description"/>
<meta content="https://api.github.com/_private/browser/stats" name="browser-stats-url">
<meta content="https://api.github.com/_private/browser/errors" name="browser-errors-url">
<link href="https://assets-cdn.github.com/" rel="assets">
<meta content="1000" name="pjax-timeout">
<meta content="/windows-tile.png" name="msapplication-TileImage">
<meta content="#ffffff" name="msapplication-TileColor">
<meta data-pjax-transient="" name="selected-link" value="repo_wiki">
<meta content="KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU" name="google-site-verification">
<meta content="UA-3769691-2" name="google-analytics">
<meta content="collector.githubapp.com" name="octolytics-host"/><meta content="github" name="octolytics-app-id"/><meta content="7250A4CA:6924:139E05F7:5670C038" name="octolytics-dimension-request_id"/>
<meta content="/&lt;user-name&gt;/&lt;repo-name&gt;/wiki/show" data-pjax-transient="true" name="analytics-location"/>
<meta content="Rails, view, wiki#show" data-pjax-transient="true" name="analytics-event"/>
<meta class="js-ga-set" content="Logged Out" name="dimension1">
<meta content="github.com" name="hostname">
<meta content="" name="user-login">
<meta content="github.com" name="expected-hostname">
<link color="#4078c0" href="https://assets-cdn.github.com/pinned-octocat.svg" rel="mask-icon">
<link href="https://assets-cdn.github.com/favicon.ico" rel="icon" type="image/x-icon">
<meta content="4ec622d68ce7b9650a1300bfb9c826e8db34d456" name="form-nonce"/>
<link crossorigin="anonymous" href="src/350888e1495e7af27e01faa9d8291dee.css" media="all" rel="stylesheet"/>
<link crossorigin="anonymous" href="src/9fae9b7d8f0785d745a43c6465f74ae5.css" media="all" rel="stylesheet"/>
<meta content="cd9958d45e48e8e3157a320e9c346eaa" http-equiv="x-pjax-version">
<meta content="pomelo - A fast,scalable,distributed game server framework for Node.js." name="description">
<meta content="github.com/NetEase/pomelo git https://github.com/NetEase/pomelo.git" name="go-import">
<meta content="1460597" name="octolytics-dimension-user_id"/><meta content="NetEase" name="octolytics-dimension-user_login"/><meta content="5880912" name="octolytics-dimension-repository_id"/><meta content="NetEase/pomelo" name="octolytics-dimension-repository_nwo"/><meta content="true" name="octolytics-dimension-repository_public"/><meta content="false" name="octolytics-dimension-repository_is_fork"/><meta content="5880912" name="octolytics-dimension-repository_network_root_id"/><meta content="NetEase/pomelo" name="octolytics-dimension-repository_network_root_nwo"/>
<link href="https://github.com/NetEase/pomelo/commits/master.atom" rel="alternate" title="Recent Commits to pomelo:master" type="application/atom+xml">
</link></meta></meta></meta></link></link></meta></meta></meta></meta></meta></meta></meta></meta></meta></meta></link></meta></meta></meta></link></link></link></link></link></link></meta></meta></meta></meta></head><body style="padding:0 25px;"><div class="gollum-markdown-content instapaper_body" id="wiki-body">
<div class="markdown-body">
<h1>
<a aria-hidden="true" class="anchor" href="#lordofpomelo%E4%BB%8B%E7%BB%8D" id="user-content-lordofpomelo介绍"><span class="octicon octicon-link"></span></a>Lordofpomelo介绍</h1>
<p>Lordofpomelo是一个基于pomelo框架开发的分布式MMO RPG游戏Demo。</p>
<h2>
<a aria-hidden="true" class="anchor" href="#lordofpomelo-%E7%9A%84%E7%BB%84%E9%98%9F%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97" id="user-content-lordofpomelo-的组队功能模块"><span class="octicon octicon-link"></span></a>Lordofpomelo 的组队功能模块</h2>
<p>组队功能是玩家之间互动的一种方式. 玩家可以创建队伍并邀请其他玩家加入, 其他玩家也可以主动向队长提出申请加入队伍, 队伍的人数上限为3, 如下图所示:</p>
<p><img alt="team" data-canonical-src="http://pomelo.netease.com/resource/documentImage/lordofpomelo/team.png" src="https://camo.githubusercontent.com/0e78cfc8dd508be423a200f5f9e133b257b80d25/687474703a2f2f706f6d656c6f2e6e6574656173652e636f6d2f7265736f757263652f646f63756d656e74496d6167652f6c6f72646f66706f6d656c6f2f7465616d2e706e67"/></p>
<p>"teamHandler.js"为协议入口模块, 负责处理队伍相关操作的前期判断和后期通知. teamHandler做完前期判断之后, 通过一个rpc将操作所需的参数传给manager服务器. 队伍对象的管理工作是由manager服务器所持有一个全局的"teamManager.js"模块来负责的. 在teamManager中管理所有的team对象的创建,更改及销毁等操作. </p>
<p>队伍id从"1"开始递增, 所有场景中的队伍使用统一的id序列, 当manager服务器重启时, 队伍id也重新初始化为"1". 在"team.js"模块中维护一个队伍对象中的所有成员及成员身份, 维护一个队伍频道来通知各成员队伍相关的消息及进行队伍内的聊天. </p>
<p>同一队伍中的玩家可以进入同一个组队副本.</p>
<h2>
<a aria-hidden="true" class="anchor" href="#lordofpomelo-%E7%9A%84%E5%89%AF%E6%9C%AC%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97" id="user-content-lordofpomelo-的副本功能模块"><span class="octicon octicon-link"></span></a>Lordofpomelo 的副本功能模块</h2>
<p>目前有两种副本可以供玩家进入: 组队副本和单人副本. 在desert场景(Scene I)中的Malygos, Illidan可以分别把玩家带入组队副本和单人副本, 如下图所示:</p>
<p><img alt="game copy" data-canonical-src="http://pomelo.netease.com/resource/documentImage/lordofpomelo/gameCopy.png" src="https://camo.githubusercontent.com/8f44174b6202fe7317d55e60060cf22bc8cbe03d/687474703a2f2f706f6d656c6f2e6e6574656173652e636f6d2f7265736f757263652f646f63756d656e74496d6167652f6c6f72646f66706f6d656c6f2f67616d65436f70792e706e67" width="765px"/></p>
<p>当队伍中有两个及以上玩家, 队长点击Malygos进入组队副本时, 队伍中的队员会被同时拉入副本中. 队伍中的队员也可以单独进入组队副本, 但不会触发将队伍中的其他成员拉入副本的操作, 其他成员可以分别进入该副本. </p>
<p>玩家进入副本也被视为切换场景, 在"areaService.js"模块中的changeArea函数中进行目标场景类型判断, 如果是普通场景则正常切换, 如果是副本场景则通过一个rpc来创建副本. 组队副本创建时的id与队伍id相关, 单人副本创建时的id与玩家id相关. 组队副本创建成功后, 如果是队长触发的操作则向其他队员客户端发送进入副本的命令, 如果是队员则直接进入副本中.</p>
<p>副本("instance.js")本质上是一个临时的场景, 并对进入该临时场景的玩家进行限制. instance由模块"instancePool.js"来统一管理, 这与队伍功能模块的结构是相同的.</p>
</div>
</div></body></html>
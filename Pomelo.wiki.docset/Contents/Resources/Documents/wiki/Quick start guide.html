<html><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# object: http://ogp.me/ns/object# article: http://ogp.me/ns/article# profile: http://ogp.me/ns/profile#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="en" http-equiv="Content-Language">
<meta content="width=1020" name="viewport">
<title>Quick start guide · NetEase/pomelo Wiki · GitHub</title>
<link href="/opensearch.xml" rel="search" title="GitHub" type="application/opensearchdescription+xml">
<link href="src/ad667adaa2cfe8f3caa4a41b7d0a79a1.png" rel="fluid-icon" title="GitHub">
<link href="src/a10d19ff5f738940a7a5086be334f50b.png" rel="apple-touch-icon" sizes="57x57">
<link href="src/a10d19ff5f738940a7a5086be334f50b.png" rel="apple-touch-icon" sizes="114x114">
<link href="src/b4cd268bc600cc14d2cdd557de6da2fb.png" rel="apple-touch-icon" sizes="72x72">
<link href="src/b4cd268bc600cc14d2cdd557de6da2fb.png" rel="apple-touch-icon" sizes="144x144">
<meta content="1401488693436528" property="fb:app_id">
<meta content="@github" name="twitter:site"/><meta content="summary" name="twitter:card"/><meta content="NetEase/pomelo" name="twitter:title"/><meta content="pomelo - A fast,scalable,distributed game server framework for Node.js." name="twitter:description"/><meta content="https://avatars0.githubusercontent.com/u/1460597?v=3&amp;s=400" name="twitter:image:src"/>
<meta content="GitHub" property="og:site_name"/><meta content="object" property="og:type"/><meta content="https://avatars0.githubusercontent.com/u/1460597?v=3&amp;s=400" property="og:image"/><meta content="NetEase/pomelo" property="og:title"/><meta content="https://github.com/NetEase/pomelo" property="og:url"/><meta content="pomelo - A fast,scalable,distributed game server framework for Node.js." property="og:description"/>
<meta content="https://api.github.com/_private/browser/stats" name="browser-stats-url">
<meta content="https://api.github.com/_private/browser/errors" name="browser-errors-url">
<link href="https://assets-cdn.github.com/" rel="assets">
<meta content="1000" name="pjax-timeout">
<meta content="/windows-tile.png" name="msapplication-TileImage">
<meta content="#ffffff" name="msapplication-TileColor">
<meta data-pjax-transient="" name="selected-link" value="repo_wiki">
<meta content="KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU" name="google-site-verification">
<meta content="UA-3769691-2" name="google-analytics">
<meta content="collector.githubapp.com" name="octolytics-host"/><meta content="github" name="octolytics-app-id"/><meta content="CA86616A:2F42:FB6DE11:5670C11B" name="octolytics-dimension-request_id"/>
<meta content="/&lt;user-name&gt;/&lt;repo-name&gt;/wiki/show" data-pjax-transient="true" name="analytics-location"/>
<meta content="Rails, view, wiki#show" data-pjax-transient="true" name="analytics-event"/>
<meta class="js-ga-set" content="Logged Out" name="dimension1">
<meta content="github.com" name="hostname">
<meta content="" name="user-login">
<meta content="github.com" name="expected-hostname">
<link color="#4078c0" href="https://assets-cdn.github.com/pinned-octocat.svg" rel="mask-icon">
<link href="https://assets-cdn.github.com/favicon.ico" rel="icon" type="image/x-icon">
<meta content="82e2408dab73c0f81d487854c2a752f5e17c96f7" name="form-nonce"/>
<link crossorigin="anonymous" href="src/350888e1495e7af27e01faa9d8291dee.css" media="all" rel="stylesheet"/>
<link crossorigin="anonymous" href="src/9fae9b7d8f0785d745a43c6465f74ae5.css" media="all" rel="stylesheet"/>
<meta content="cd9958d45e48e8e3157a320e9c346eaa" http-equiv="x-pjax-version">
<meta content="pomelo - A fast,scalable,distributed game server framework for Node.js." name="description">
<meta content="github.com/NetEase/pomelo git https://github.com/NetEase/pomelo.git" name="go-import">
<meta content="1460597" name="octolytics-dimension-user_id"/><meta content="NetEase" name="octolytics-dimension-user_login"/><meta content="5880912" name="octolytics-dimension-repository_id"/><meta content="NetEase/pomelo" name="octolytics-dimension-repository_nwo"/><meta content="true" name="octolytics-dimension-repository_public"/><meta content="false" name="octolytics-dimension-repository_is_fork"/><meta content="5880912" name="octolytics-dimension-repository_network_root_id"/><meta content="NetEase/pomelo" name="octolytics-dimension-repository_network_root_nwo"/>
<link href="https://github.com/NetEase/pomelo/commits/master.atom" rel="alternate" title="Recent Commits to pomelo:master" type="application/atom+xml">
</link></meta></meta></meta></link></link></meta></meta></meta></meta></meta></meta></meta></meta></meta></meta></link></meta></meta></meta></link></link></link></link></link></link></meta></meta></meta></meta></head><body style="padding:0 25px;"><div class="gollum-markdown-content instapaper_body" id="wiki-body">
<div class="markdown-body">
<p>This document will guide you through the process of installing Pomelo, show you how to create your first application &amp; explain some of the core concepts behind the framework itself. </p>
<p>Pomelo comes with a command line utility which provides a range of commands to simplify the development process. All these commands are thoroughly tested on linux, mac and windows os.</p>
<h2>
<a aria-hidden="true" class="anchor" href="#installing-pomelo" id="user-content-installing-pomelo"><span class="octicon octicon-link"></span></a>Installing Pomelo</h2>
<p>The following process is somewhat misleading, refer to this page instead. <a href="https://github.com/NetEase/pomelo/wiki/Installation">Installation</a></p>
<blockquote>
<p>This guide assumes you have already installed <code>node</code> &amp; <code>npm</code>.</p>
<p><strong>Linux / OSX / Windows</strong>:</p>
<div class="highlight highlight-source-shell"><pre>$ npm install pomelo -g</pre></div>
<p><strong>Windows</strong>:</p>
<p>Make sure you have installed <code>node.js source code compiling tools</code>.</p>
<p>node.js uses <a href="http://code.google.com/p/gyp/">gyp</a> to generate the Visual Studio Solution file, which is compiled to a binary file by the VC++ compiler.</p>
<p>Minimum requirements for installing Pomelo on windows:</p>
<ul>
<li>
<a href="http://python.org/">Python</a> ( 2.5 &lt; version &lt; 3.0 ).</li>
<li>VC++ compiler, included in <a href="http://msdn.microsoft.com/en-us/vstudio/hh388567">Visual Studio 2010</a> or VC++ 2010 Express.</li>
</ul>
<p>Then install the Pomelo command line utility.</p>
<div class="highlight highlight-source-shell"><pre><span class="pl-k">&gt;</span> npm install pomelo-cli -g</pre></div>
</blockquote>
<h2>
<a aria-hidden="true" class="anchor" href="#usage" id="user-content-usage"><span class="octicon octicon-link"></span></a>Usage</h2>
<h3>
<a aria-hidden="true" class="anchor" href="#creating-a-new-project" id="user-content-creating-a-new-project"><span class="octicon octicon-link"></span></a>Creating a new project</h3>
<p>Pomelo provides an interactive installer which will guide you through the process &amp; install all the files you will need for your first project.</p>
<p>To create your first project:</p>
<div class="highlight highlight-source-shell"><pre>$ <span class="pl-c1">cd</span> /var/www/
$ pomelo init helloWorld
$ <span class="pl-c1">cd</span> helloWorld/
$ sh npm-install.sh </pre></div>
<p>A new project is made up of the following directories:</p>
<p><img alt="directory structure" data-canonical-src="http://pomelo.netease.com/resource/documentImage/helloWorldFolder.png" src="https://camo.githubusercontent.com/34e97812a129a56d38e6554630f8f02247d12550/687474703a2f2f706f6d656c6f2e6e6574656173652e636f6d2f7265736f757263652f646f63756d656e74496d6167652f68656c6c6f576f726c64466f6c6465722e706e67"/></p>
<p>Your new application is split in to 2 main directories called <code>game-server</code> and <code>web-server</code>.</p>
<table>
<thead>
<tr>
<th align="left">Directory</th>
<th align="left">More Info</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><strong>/game-server</strong></td>
<td align="left">Contains all server side code related to the game dynamics &amp; components.</td>
</tr>
<tr>
<td align="left"><strong>/web-server</strong></td>
<td align="left">Contains a web server based on expressjs for serving client-side code &amp; web content.</td>
</tr>
<tr>
<td align="left">/game-server/config</td>
<td align="left">Contains configuration files to set up &amp; tweak your server-side environment.</td>
</tr>
<tr>
<td align="left">/logs</td>
<td align="left">Contains all the application logs which prove essential in debugging your application.</td>
</tr>
<tr>
<td align="left">/shared</td>
<td align="left">Can be used to share javascript files between the client &amp; server (if applicable).</td>
</tr>
</tbody>
</table>
<h3>
<a aria-hidden="true" class="anchor" href="#start-project" id="user-content-start-project"><span class="octicon octicon-link"></span></a>Start project</h3>
<p>Both game-server and web-server should be started, and game-server can be started by  the following command </p>
<p><code>pomelo start [development | production] [--daemon]</code> </p>
<p>while web-server is started like this:
 <code>cd web-server &amp;&amp; node app</code></p>
<p>Running in different environment, the project needs different start arguments. If the running environment is development, the argument should be development, otherwise it should be production. By default the project runs in foreground model, and the argument '--daemon' can let project run in background model. </p>
<p>If you use “–daemon” argument, the module 'forever' should be installed by command <code>npm install forever -g</code></p>
<p>You can also start the game-server with this command:</p>
<p><code>node app [env=development | env=production]</code></p>
<p>After project started, you can visit website of 'http://localhost:3001' or '<a href="http://127.0.0.1:3001">http://127.0.0.1:3001</a>' by browser with
websocket support.</p>
<h3>
<a aria-hidden="true" class="anchor" href="#query-server-status" id="user-content-query-server-status"><span class="octicon octicon-link"></span></a>Query server status</h3>
<p>You can query server status with the command <code>pomelo list</code>, and the example of result is shown as follows:</p>
<p><img alt="test" data-canonical-src="http://pomelo.netease.com/resource/documentImage/pomeloList.png" src="https://camo.githubusercontent.com/3849b9a5f607516bd11d11bbcb6f67b6a6c1e15e/687474703a2f2f706f6d656c6f2e6e6574656173652e636f6d2f7265736f757263652f646f63756d656e74496d6167652f706f6d656c6f4c6973742e706e67"/></p>
<p>The followings are detailed definition of each fields:</p>
<ul>
<li>serverId: the id of server which is the same as configuration</li>
<li>serverType: the type of server which is the same as configuration</li>
<li>pid: the pid of process corresponding to server</li>
<li>headUsed: the used heap size of server(Unit: Megabytes)</li>
<li>uptime: the duration since this server started(Unit: Minute)</li>
</ul>
<h3>
<a aria-hidden="true" class="anchor" href="#shutdown-project" id="user-content-shutdown-project"><span class="octicon octicon-link"></span></a>Shutdown project</h3>
<p>Both commands <code>pomelo stop</code> and <code>pomelo kill</code> can shutdown the project. The command <code>pomelo stop</code> is recommended for some
reasons as follows:</p>
<ul>
<li>front-end servers disconnect to keep players from coming in </li>
<li>Guarantee game logic with closing all of the servers by certain order</li>
<li>Ensure data integrity with writing plays' information to the database in time </li>
</ul>
<p>command <code>pomelo stop id</code> will dynamically shutdown the server corresponding to the given id.</p>
<p>Please avoid the way with command <code>pomelo kill</code> in production environment. Use it only to kill if there is  no other remedy. </p>
<h3>
<a aria-hidden="true" class="anchor" href="#add-server" id="user-content-add-server"><span class="octicon octicon-link"></span></a>add server</h3>
<p><code>pomelo add host=[host] port=[port] id=[id] serverType=[serverType]</code> can help you add server with the given arguments dynamically. Now this command is only for backend server, and required in the project root directory.</p>
<h2>
<a aria-hidden="true" class="anchor" href="#adminconsole" id="user-content-adminconsole"><span class="octicon octicon-link"></span></a>AdminConsole</h2>
<p>AdminConsole is a powerful tool which can monitor the project and get valuable information. You can do the following things with adminConsole.</p>
<ul>
<li>Monitor server status, logs, online users and scene data etc.</li>
<li>Get related information with scripts flexibly.</li>
<li>Trace and analyze memory stack, CPU consumption </li>
</ul>
<p>sysstat tool is required for AdminConsole on linux, so you should install sysstat tool by <code>apt-get install sysstat</code> .</p>
<h3>
<a aria-hidden="true" class="anchor" href="#install-adminconsole" id="user-content-install-adminconsole"><span class="octicon octicon-link"></span></a>Install adminConsole</h3>
<blockquote>
<p>git clone <a href="https://github.com/NetEase/pomelo-admin-web.git">https://github.com/NetEase/pomelo-admin-web.git</a></p>
<p>cd pomelo-admin-web</p>
<p>npm install -d</p>
<p>node app</p>
</blockquote>
<p>If you have not installed sysstat on linux, execute the following command:</p>
<blockquote>
<p>apt-get install sysstat</p>
</blockquote>
<p>Open the console by visiting website of 'http://localhost:7001' with browser which supports websocket. If there are any port conflicts, please fix configuration in 'config/admin.json'.The system closes the admin console module in default, so you need to open it in game-server/app.js and add the code app.enable('systemMonitor'). You can refer to the source code of lordofpomelo in detail.</p>
<h2>
<a aria-hidden="true" class="anchor" href="#project-in-production-environment" id="user-content-project-in-production-environment"><span class="octicon octicon-link"></span></a>Project in production environment</h2>
<p>If multi-server environment, not only all the servers should support "ssh agent forward", but also the project directory structure of each
server should be exactly the same.</p>
<p>Here are some references about 'ssh agent forward':</p>
<ul>
<li><a href="http://kimmo.suominen.com/docs/ssh/">Getting Started with SSH</a></li>
<li><a href="http://en.wikipedia.org/wiki/Ssh-agent">What is an SSH Agent</a></li>
<li><a href="http://unixwiz.net/techtips/ssh-agent-forwarding.html">How SSH Agent Forwarding Works</a></li>
<li><a href="https://help.github.com/articles/managing-deploy-keys">What are deploy keys?</a></li>
</ul>
</div>
</div></body></html>
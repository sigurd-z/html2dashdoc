<html><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# object: http://ogp.me/ns/object# article: http://ogp.me/ns/article# profile: http://ogp.me/ns/profile#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="en" http-equiv="Content-Language">
<meta content="width=1020" name="viewport">
<title>Log management · NetEase/pomelo Wiki · GitHub</title>
<link href="/opensearch.xml" rel="search" title="GitHub" type="application/opensearchdescription+xml">
<link href="src/ad667adaa2cfe8f3caa4a41b7d0a79a1.png" rel="fluid-icon" title="GitHub">
<link href="src/a10d19ff5f738940a7a5086be334f50b.png" rel="apple-touch-icon" sizes="57x57">
<link href="src/a10d19ff5f738940a7a5086be334f50b.png" rel="apple-touch-icon" sizes="114x114">
<link href="src/b4cd268bc600cc14d2cdd557de6da2fb.png" rel="apple-touch-icon" sizes="72x72">
<link href="src/b4cd268bc600cc14d2cdd557de6da2fb.png" rel="apple-touch-icon" sizes="144x144">
<meta content="1401488693436528" property="fb:app_id">
<meta content="@github" name="twitter:site"/><meta content="summary" name="twitter:card"/><meta content="NetEase/pomelo" name="twitter:title"/><meta content="pomelo - A fast,scalable,distributed game server framework for Node.js." name="twitter:description"/><meta content="https://avatars0.githubusercontent.com/u/1460597?v=3&amp;s=400" name="twitter:image:src"/>
<meta content="GitHub" property="og:site_name"/><meta content="object" property="og:type"/><meta content="https://avatars0.githubusercontent.com/u/1460597?v=3&amp;s=400" property="og:image"/><meta content="NetEase/pomelo" property="og:title"/><meta content="https://github.com/NetEase/pomelo" property="og:url"/><meta content="pomelo - A fast,scalable,distributed game server framework for Node.js." property="og:description"/>
<meta content="https://api.github.com/_private/browser/stats" name="browser-stats-url">
<meta content="https://api.github.com/_private/browser/errors" name="browser-errors-url">
<link href="https://assets-cdn.github.com/" rel="assets">
<meta content="1000" name="pjax-timeout">
<meta content="/windows-tile.png" name="msapplication-TileImage">
<meta content="#ffffff" name="msapplication-TileColor">
<meta data-pjax-transient="" name="selected-link" value="repo_wiki">
<meta content="KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU" name="google-site-verification">
<meta content="UA-3769691-2" name="google-analytics">
<meta content="collector.githubapp.com" name="octolytics-host"/><meta content="github" name="octolytics-app-id"/><meta content="7250A4CA:6926:ECC6822:5670C034" name="octolytics-dimension-request_id"/>
<meta content="/&lt;user-name&gt;/&lt;repo-name&gt;/wiki/show" data-pjax-transient="true" name="analytics-location"/>
<meta content="Rails, view, wiki#show" data-pjax-transient="true" name="analytics-event"/>
<meta class="js-ga-set" content="Logged Out" name="dimension1">
<meta content="github.com" name="hostname">
<meta content="" name="user-login">
<meta content="github.com" name="expected-hostname">
<link color="#4078c0" href="https://assets-cdn.github.com/pinned-octocat.svg" rel="mask-icon">
<link href="https://assets-cdn.github.com/favicon.ico" rel="icon" type="image/x-icon">
<meta content="80d4f2f7d08c93d3a9879a043252ea869b92aeb1" name="form-nonce"/>
<link crossorigin="anonymous" href="src/350888e1495e7af27e01faa9d8291dee.css" media="all" rel="stylesheet"/>
<link crossorigin="anonymous" href="src/9fae9b7d8f0785d745a43c6465f74ae5.css" media="all" rel="stylesheet"/>
<meta content="cd9958d45e48e8e3157a320e9c346eaa" http-equiv="x-pjax-version">
<meta content="pomelo - A fast,scalable,distributed game server framework for Node.js." name="description">
<meta content="github.com/NetEase/pomelo git https://github.com/NetEase/pomelo.git" name="go-import">
<meta content="1460597" name="octolytics-dimension-user_id"/><meta content="NetEase" name="octolytics-dimension-user_login"/><meta content="5880912" name="octolytics-dimension-repository_id"/><meta content="NetEase/pomelo" name="octolytics-dimension-repository_nwo"/><meta content="true" name="octolytics-dimension-repository_public"/><meta content="false" name="octolytics-dimension-repository_is_fork"/><meta content="5880912" name="octolytics-dimension-repository_network_root_id"/><meta content="NetEase/pomelo" name="octolytics-dimension-repository_network_root_nwo"/>
<link href="https://github.com/NetEase/pomelo/commits/master.atom" rel="alternate" title="Recent Commits to pomelo:master" type="application/atom+xml">
</link></meta></meta></meta></link></link></meta></meta></meta></meta></meta></meta></meta></meta></meta></meta></link></meta></meta></meta></link></link></link></link></link></link></meta></meta></meta></meta></head><body style="padding:0 25px;"><div class="gollum-markdown-content instapaper_body" id="wiki-body">
<div class="markdown-body">
<h1>
<a aria-hidden="true" class="anchor" href="#log-management" id="user-content-log-management"><span class="octicon octicon-link"></span></a>Log Management</h1>
<p>Log in pomelo is maintained by <a href="https://github.com/NetEase/pomelo-logger">pomelo-logger</a>, which is a simple wrapper of <a href="https://github.com/nomiddlename/log4js-node">log4js</a> and provides some very useful additional features.</p>
<p>Logs can be divided into categories to maintain, and categories can be configured in log4js.json file, Here is an example as follows: </p>
<div class="highlight highlight-source-json"><pre>{
  <span class="pl-s"><span class="pl-pds">"</span>appenders<span class="pl-pds">"</span></span>: [
    {
      <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>console<span class="pl-pds">"</span></span>
    },
    {
      <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>file<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>filename<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>./logs/con-log-${opts: serverId}.log<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>pattern<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>connector<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>maxLogSize<span class="pl-pds">"</span></span>: <span class="pl-c1">1048576</span>,
      <span class="pl-s"><span class="pl-pds">"</span>layout<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>basic<span class="pl-pds">"</span></span>
      },
      <span class="pl-s"><span class="pl-pds">"</span>backups<span class="pl-pds">"</span></span>: <span class="pl-c1">5</span>,
      <span class="pl-s"><span class="pl-pds">"</span>category<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>con-log<span class="pl-pds">"</span></span>
    },
    {
      <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>file<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>filename<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>./logs/rpc-log-${opts: serverId}.log<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>maxLogSize<span class="pl-pds">"</span></span>: <span class="pl-c1">1048576</span>,
      <span class="pl-s"><span class="pl-pds">"</span>layout<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>basic<span class="pl-pds">"</span></span>
      },
      <span class="pl-s"><span class="pl-pds">"</span>backups<span class="pl-pds">"</span></span>: <span class="pl-c1">5</span>,
      <span class="pl-s"><span class="pl-pds">"</span>category<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>rpc-log<span class="pl-pds">"</span></span>
    },
    {
      <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>file<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>filename<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>./logs/forward-log-${opts: serverId}.log<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>maxLogSize<span class="pl-pds">"</span></span>: <span class="pl-c1">1048576</span>,
      <span class="pl-s"><span class="pl-pds">"</span>layout<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>basic<span class="pl-pds">"</span></span>
      },
      <span class="pl-s"><span class="pl-pds">"</span>backups<span class="pl-pds">"</span></span>: <span class="pl-c1">5</span>,
      <span class="pl-s"><span class="pl-pds">"</span>category<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>forward-log<span class="pl-pds">"</span></span>
    },
    {
      <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>file<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>filename<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>./logs/rpc-debug- $ {opts: serverId}. log<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>maxLogSize<span class="pl-pds">"</span></span>: <span class="pl-c1">1048576</span>,
      <span class="pl-s"><span class="pl-pds">"</span>layout<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>basic<span class="pl-pds">"</span></span>
      },
      <span class="pl-s"><span class="pl-pds">"</span>backups<span class="pl-pds">"</span></span>: <span class="pl-c1">5</span>,
      <span class="pl-s"><span class="pl-pds">"</span>category<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>rpc-debug<span class="pl-pds">"</span></span>
    },
    {
      <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>file<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>filename<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>. / logs / crash.log<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>maxLogSize<span class="pl-pds">"</span></span>: <span class="pl-c1">1048576</span>,
      <span class="pl-s"><span class="pl-pds">"</span>layout<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>basic<span class="pl-pds">"</span></span>
      },
      <span class="pl-s"><span class="pl-pds">"</span>backups<span class="pl-pds">"</span></span>: <span class="pl-c1">5</span>,
      <span class="pl-s"><span class="pl-pds">"</span>category<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>crash-log<span class="pl-pds">"</span></span>
    },
    {
      <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>file<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>filename<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>. / logs / admin.log<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>maxLogSize<span class="pl-pds">"</span></span>: <span class="pl-c1">1048576</span>,
      <span class="pl-s"><span class="pl-pds">"</span>layout<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>basic<span class="pl-pds">"</span></span>
      }
      <span class="pl-s"><span class="pl-pds">"</span>backups<span class="pl-pds">"</span></span><span class="pl-ii">:</span> <span class="pl-c1">5</span>,
      <span class="pl-s"><span class="pl-pds">"</span>category<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>admin-log<span class="pl-pds">"</span></span>
    },
    {
      <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>file<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>filename<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>. / logs / pomelo.log<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>maxLogSize<span class="pl-pds">"</span></span>: <span class="pl-c1">1048576</span>,
      <span class="pl-s"><span class="pl-pds">"</span>layout<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>basic<span class="pl-pds">"</span></span>
      }
      <span class="pl-s"><span class="pl-pds">"</span>backups<span class="pl-pds">"</span></span><span class="pl-ii">:</span> <span class="pl-c1">5</span>,
      <span class="pl-s"><span class="pl-pds">"</span>category<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>pomelo<span class="pl-pds">"</span></span>
    }
  ],

  <span class="pl-s"><span class="pl-pds">"</span>levels<span class="pl-pds">"</span></span>: {
  <span class="pl-s"><span class="pl-pds">"</span>rpc-log<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>ERROR<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>forward-log<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>ERROR<span class="pl-pds">"</span></span>
  },
  <span class="pl-s"><span class="pl-pds">"</span>replaceConsole<span class="pl-pds">"</span></span>: <span class="pl-c1">true</span>,
  <span class="pl-s"><span class="pl-pds">"</span>lineDebug<span class="pl-pds">"</span></span>: <span class="pl-c1">false</span>
}
</pre></div>
<p>As can be seen from the configuration file, each configuration item (except console) is configured with a category. A logger can be obtained by calling <strong>getLogger</strong> method of pomelo-logger with a specific category as its first argument, and then the logger will output the generated logs to file or other device based on the configuration in the configuration file of that category.</p>
<p>You can also add your own log category, and configure how to output the logs of that category, and then call <strong>getLogger</strong> to get the logger for that category, and the logger can be used in your project.</p>
<p><strong>Note</strong>: It is not recommended to use logger that belongs to no category, if so, the log will be output based on global configuration.</p>
<h3>
<a aria-hidden="true" class="anchor" href="#log-categories" id="user-content-log-categories"><span class="octicon octicon-link"></span></a>Log Categories</h3>
<p>There are several categories configured in the configuration file, each category indicates a logger for specific purpose:</p>
<ul>
<li>pomelo: logger for pomelo framework;</li>
<li>admin-log: logger for server management framework;</li>
<li>crash-log: logger for server exception; </li>
<li>rpc-debug: logger for RPC invocation, it is required to enable <a href="https://github.com/NetEase/pomelo/wiki/Pomelo%27s-new-features-in-version-0.6">rpc-debug feature</a> first;</li>
<li>forward-log: logger for frontend servers forwarding requests from clients to backend servers; </li>
<li>rpc-log: logger for RPC filter; </li>
<li>con-log: logger for handler filter. </li>
</ul>
<h3>
<a aria-hidden="true" class="anchor" href="#log-levels" id="user-content-log-levels"><span class="octicon octicon-link"></span></a>Log Levels</h3>
<p>Log levels indicate the severities of logs, it can be used to determine log output, Here is an example:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-s"><span class="pl-pds">"</span>levels<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
  <span class="pl-s"><span class="pl-pds">"</span>rpc-log<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>ERROR<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>forward-log<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>ERROR<span class="pl-pds">"</span></span>
}</pre></div>
<p>The following presents all the log levels, their severity is becoming higher and higher from left to right:</p>
<pre><code>TRACE, DEBUG, INFO, WARN, ERROR, FATAL
</code></pre>
<p>The lower is the level configured for a category, the more log will be output, and vice versa. For example:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> rpc_logger <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>pomelo-logger<span class="pl-pds">'</span></span>).<span class="pl-en">getLogger</span> (<span class="pl-s"><span class="pl-pds">'</span>rpc-log<span class="pl-pds">'</span></span>, <span class="pl-c1">__filename</span>);
<span class="pl-smi">rpc_logger</span>.<span class="pl-en">info</span> (<span class="pl-s"><span class="pl-pds">"</span>msg<span class="pl-pds">"</span></span>);</pre></div>
<p>Here rpc_logger uses <strong>info</strong> method, meaning the level is INFO, however the levels of that category is configured to ERROR, so the log would not be output. </p>
<p>But if you change the levels configuration for rpc_logger, make it be below INFO level such as DEBUG, and then the log will be output.</p>
<h3>
<a aria-hidden="true" class="anchor" href="#configuration-items" id="user-content-configuration-items"><span class="octicon octicon-link"></span></a>Configuration Items</h3>
<ul>
<li>type: It specifies the type of appender, it can be console, dataFile, file , etc., more detail at <a href="https://github.com/nomiddlename/log4js-node/wiki/Appenders">log4js</a>;</li>
<li>filename: It specifies the output file path;</li>
<li>pattern: It specifies the pattern of log output;</li>
<li>maxLogSize: It specifies the maximum size of log output;</li>
<li>layout: It specifies the layout style for outputting log;</li>
<li>backups: It specifies the maximum number of output files;</li>
<li>category: It specifies the corresponding category to the appender. Non-configured on it indicates that the appender is a global appender;</li>
<li>replaceConsole: It specifies whether to replace the default console;</li>
<li>lineDebug: It specifies whether to enable debug to show the number oflog lines. </li>
</ul>
</div>
</div></body></html>
<html><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# object: http://ogp.me/ns/object# article: http://ogp.me/ns/article# profile: http://ogp.me/ns/profile#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="en" http-equiv="Content-Language">
<meta content="width=1020" name="viewport">
<title>pomelo的HelloWorld · NetEase/pomelo Wiki · GitHub</title>
<link href="/opensearch.xml" rel="search" title="GitHub" type="application/opensearchdescription+xml">
<link href="src/ad667adaa2cfe8f3caa4a41b7d0a79a1.png" rel="fluid-icon" title="GitHub">
<link href="src/a10d19ff5f738940a7a5086be334f50b.png" rel="apple-touch-icon" sizes="57x57">
<link href="src/a10d19ff5f738940a7a5086be334f50b.png" rel="apple-touch-icon" sizes="114x114">
<link href="src/b4cd268bc600cc14d2cdd557de6da2fb.png" rel="apple-touch-icon" sizes="72x72">
<link href="src/b4cd268bc600cc14d2cdd557de6da2fb.png" rel="apple-touch-icon" sizes="144x144">
<meta content="1401488693436528" property="fb:app_id">
<meta content="@github" name="twitter:site"/><meta content="summary" name="twitter:card"/><meta content="NetEase/pomelo" name="twitter:title"/><meta content="pomelo - A fast,scalable,distributed game server framework for Node.js." name="twitter:description"/><meta content="https://avatars0.githubusercontent.com/u/1460597?v=3&amp;s=400" name="twitter:image:src"/>
<meta content="GitHub" property="og:site_name"/><meta content="object" property="og:type"/><meta content="https://avatars0.githubusercontent.com/u/1460597?v=3&amp;s=400" property="og:image"/><meta content="NetEase/pomelo" property="og:title"/><meta content="https://github.com/NetEase/pomelo" property="og:url"/><meta content="pomelo - A fast,scalable,distributed game server framework for Node.js." property="og:description"/>
<meta content="https://api.github.com/_private/browser/stats" name="browser-stats-url">
<meta content="https://api.github.com/_private/browser/errors" name="browser-errors-url">
<link href="https://assets-cdn.github.com/" rel="assets">
<meta content="1000" name="pjax-timeout">
<meta content="/windows-tile.png" name="msapplication-TileImage">
<meta content="#ffffff" name="msapplication-TileColor">
<meta data-pjax-transient="" name="selected-link" value="repo_wiki">
<meta content="KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU" name="google-site-verification">
<meta content="UA-3769691-2" name="google-analytics">
<meta content="collector.githubapp.com" name="octolytics-host"/><meta content="github" name="octolytics-app-id"/><meta content="CA86616A:2F43:126D84E7:5670C104" name="octolytics-dimension-request_id"/>
<meta content="/&lt;user-name&gt;/&lt;repo-name&gt;/wiki/show" data-pjax-transient="true" name="analytics-location"/>
<meta content="Rails, view, wiki#show" data-pjax-transient="true" name="analytics-event"/>
<meta class="js-ga-set" content="Logged Out" name="dimension1">
<meta content="github.com" name="hostname">
<meta content="" name="user-login">
<meta content="github.com" name="expected-hostname">
<link color="#4078c0" href="https://assets-cdn.github.com/pinned-octocat.svg" rel="mask-icon">
<link href="https://assets-cdn.github.com/favicon.ico" rel="icon" type="image/x-icon">
<meta content="bb52bed9b1d337c80f4d86ee9b59b6f6fb6fcec5" name="form-nonce"/>
<link crossorigin="anonymous" href="src/350888e1495e7af27e01faa9d8291dee.css" media="all" rel="stylesheet"/>
<link crossorigin="anonymous" href="src/9fae9b7d8f0785d745a43c6465f74ae5.css" media="all" rel="stylesheet"/>
<meta content="cd9958d45e48e8e3157a320e9c346eaa" http-equiv="x-pjax-version">
<meta content="pomelo - A fast,scalable,distributed game server framework for Node.js." name="description">
<meta content="github.com/NetEase/pomelo git https://github.com/NetEase/pomelo.git" name="go-import">
<meta content="1460597" name="octolytics-dimension-user_id"/><meta content="NetEase" name="octolytics-dimension-user_login"/><meta content="5880912" name="octolytics-dimension-repository_id"/><meta content="NetEase/pomelo" name="octolytics-dimension-repository_nwo"/><meta content="true" name="octolytics-dimension-repository_public"/><meta content="false" name="octolytics-dimension-repository_is_fork"/><meta content="5880912" name="octolytics-dimension-repository_network_root_id"/><meta content="NetEase/pomelo" name="octolytics-dimension-repository_network_root_nwo"/>
<link href="https://github.com/NetEase/pomelo/commits/master.atom" rel="alternate" title="Recent Commits to pomelo:master" type="application/atom+xml">
</link></meta></meta></meta></link></link></meta></meta></meta></meta></meta></meta></meta></meta></meta></meta></link></meta></meta></meta></link></link></link></link></link></link></meta></meta></meta></meta></head><body style="padding:0 25px;"><div class="gollum-markdown-content instapaper_body" id="wiki-body">
<div class="markdown-body">
<p>老传统，让我们也先从HelloWorld这个例子开始吧。</p>
<h1>
<a aria-hidden="true" class="anchor" href="#%E6%96%B0%E5%BB%BA%E9%A1%B9%E7%9B%AE" id="user-content-新建项目"><span class="octicon octicon-link"></span></a>新建项目</h1>
<p>使用pomelo的命令行工具可以快速创建一个项目，命令如下：</p>
<pre><code>$ pomelo init ./HelloWorld
</code></pre>
<p>或者你也可以使用下面的三个命令：</p>
<pre><code>$ mkdir HelloWorld
$ cd HelloWorld
$ pomelo init
</code></pre>
<p>这两种创建方式是等价的，更多关于pomelo命令行使用的文档，请参阅<a href="pomelo%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8">pomelo命令行工具使用</a>。在初始化项目的时候，用户需要选择其底层使用的通信协议，分为socket.io和websocket。</p>
<p>然后，进入到HelloWorld文件夹，安装依赖包：</p>
<pre><code>$ sh npm-install.sh
</code></pre>
<p>windows用户，可以直接运行 <code>npm-install.bat</code></p>
<h1>
<a aria-hidden="true" class="anchor" href="#%E9%A1%B9%E7%9B%AE%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84" id="user-content-项目目录结构"><span class="octicon octicon-link"></span></a>项目目录结构</h1>
<p>让我们来看看一个pomelo项目的大致结构</p>
<p>新建立的项目结构如下图所示：</p>
<p><img alt="项目目录结构" src="src/43d9cf0ad069d06d1be0fc86f93c314c.png"/></p>
<p>该目录结构很清楚地展示了游戏项目的前后端分层结构，分别在各个目录下填写相关代码，即可快速开发游戏。下面对各个目录进行简要分析：</p>
<h4>
<a aria-hidden="true" class="anchor" href="#game-server" id="user-content-game-server"><span class="octicon octicon-link"></span></a>game-server</h4>
<p>game-server是用pomelo框架搭建的游戏服务器，以文件app.js作为入口，运行游戏的所有逻辑和功能。在接下来的开发中，所有游戏逻辑、功能、配置等都在该目录下进行。</p>
<ul>
<li>app子目录</li>
</ul>
<p>这个目录下放置所有的游戏服务器代码的地方，用户在这里实现不同类型的服务器，添加对应的Handler，Remote等等。</p>
<ul>
<li>config子目录</li>
</ul>
<p>game-server下config包括了游戏服务器的所有配置信息。配置信息以JSON文件的格式进行定义，包含有日志、master、server等服务器的配置信息。该目录还可以进行扩展，对数据库配置信息、地图信息和数值表等信息进行定义。总而言之，这里是放着所有游戏服务器相关的配置信息的地方。</p>
<ul>
<li>logs子目录</li>
</ul>
<p>日志是项目中不可或缺的，可以对项目的运行情况进行很好的备份，也是系统运维的参考数据之一，logs存放了游戏服务器所有的日志信息。</p>
<h4>
<a aria-hidden="true" class="anchor" href="#shared" id="user-content-shared"><span class="octicon octicon-link"></span></a>shared</h4>
<p>shared存放一些前后端、game-server与web-server共用代码，由于都是javascript代码，那么对于一些工具或者算法代码，就可以前后端共用，极大地提高了代码重用性。</p>
<h4>
<a aria-hidden="true" class="anchor" href="#web-server" id="user-content-web-server"><span class="octicon octicon-link"></span></a>web-server</h4>
<p>web-server是用<a href="http://expressjs.com">express 3.x</a>框架搭建的web服务器，以文件app.js作为入口，当然开发者可以选择Nginx等其他web服务器。如果游戏的客户端不是web的话，如Android平台的话，这个目录就不是必须的了。当然，在这个例子中，我们的客户端是web，所以web服务器还是必须的。</p>
<h1>
<a aria-hidden="true" class="anchor" href="#%E5%90%AF%E5%8A%A8%E9%A1%B9%E7%9B%AE" id="user-content-启动项目"><span class="octicon octicon-link"></span></a>启动项目</h1>
<p>对于我们这个例子来说，由于客户端是web，所以必须启动game-server(游戏服务器)和web-server(web服务器)</p>
<p>启动game-server服务器：</p>
<pre><code>$ cd game-server
$ pomelo start
</code></pre>
<p>启动web-server服务器：</p>
<pre><code>$ cd web-server
$ node app 
</code></pre>
<p>在启动过程中可能会有端口号冲突导致启动不成功，只需在config里面修改使用的端口号即可。如果上面的启动都没有问题的话，我们就可以对我们的HelloWorld进行测试了。用浏览器(推荐使用chrome)访问 <code>http://localhost:3001</code>或者 <code>http://127.0.0.1:3001</code> 即可, 点击Test Game Server，提示 <em>game server is ok</em> 说明运行成功，如下图所示：</p>
<p><img alt="test" src="src/f4cac83d509df3ae70e62dd891295357.png"/></p>
<h1>
<a aria-hidden="true" class="anchor" href="#%E6%9F%A5%E7%9C%8B%E6%9C%8D%E5%8A%A1%E5%99%A8" id="user-content-查看服务器"><span class="octicon octicon-link"></span></a>查看服务器</h1>
<p>可以使用<code>pomelo list</code>查看已经启动的服务器，如下图所示：</p>
<p><img alt="test" src="src/9d88e767231ef59ce96fe3f9f57e5f01.png"> </img></p>
<p>服务器状态可以查看5种状态信息：</p>
<ul>
<li>serverId：服务器的serverId，同config配置表中的id。</li>
<li>serverType：服务器的serverType，同config配置表中的type。</li>
<li>pid：服务器对应的进程pid。</li>
<li>headUsed：该服务器已经使用的堆大小（单位：兆）。</li>
<li>uptime：该服务器启动时长（单位：分钟）。</li>
</ul>
<h1>
<a aria-hidden="true" class="anchor" href="#%E5%85%B3%E9%97%AD%E9%A1%B9%E7%9B%AE" id="user-content-关闭项目"><span class="octicon octicon-link"></span></a>关闭项目</h1>
<p>可以使用以下两种方式关闭项目：</p>
<pre><code>$ cd game-server
$ pomelo stop
</code></pre>
<p>或者</p>
<pre><code>$ cd game-server
$ pomelo kill
</code></pre>
<p>其中<code>pomelo stop</code>比较优雅，<code>pomelo kill</code>比较粗暴，安全性低，开发环境下可以使用，产品环境慎用，更详细的pomelo命令行用法请参阅<a href="pomelo%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8">pomelo命令行工具使用</a>。</p>
<h1>
<a aria-hidden="true" class="anchor" href="#%E5%B0%8F%E7%BB%93" id="user-content-小结"><span class="octicon octicon-link"></span></a>小结</h1>
<p>到这里为止，我们已经成功安装了pomelo，并成功运行了HelloWorld。接下来，建议你看一下pomelo整体的一个较详细的概述。
如果你已经迫不及待地想写代码，可以去pomelo例子教程, 那里以一个chat应用为例，一步一步地向你展示如何来使用pomelo进行一个实际应用的开发，以及pomelo的一些API的使用方式等。</p>
</div>
</div></body></html>
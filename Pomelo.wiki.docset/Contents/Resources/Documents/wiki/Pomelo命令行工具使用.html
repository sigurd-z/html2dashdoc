<html><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# object: http://ogp.me/ns/object# article: http://ogp.me/ns/article# profile: http://ogp.me/ns/profile#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="en" http-equiv="Content-Language">
<meta content="width=1020" name="viewport">
<title>Pomelo命令行工具使用 · NetEase/pomelo Wiki · GitHub</title>
<link href="/opensearch.xml" rel="search" title="GitHub" type="application/opensearchdescription+xml">
<link href="src/ad667adaa2cfe8f3caa4a41b7d0a79a1.png" rel="fluid-icon" title="GitHub">
<link href="src/a10d19ff5f738940a7a5086be334f50b.png" rel="apple-touch-icon" sizes="57x57">
<link href="src/a10d19ff5f738940a7a5086be334f50b.png" rel="apple-touch-icon" sizes="114x114">
<link href="src/b4cd268bc600cc14d2cdd557de6da2fb.png" rel="apple-touch-icon" sizes="72x72">
<link href="src/b4cd268bc600cc14d2cdd557de6da2fb.png" rel="apple-touch-icon" sizes="144x144">
<meta content="1401488693436528" property="fb:app_id">
<meta content="@github" name="twitter:site"/><meta content="summary" name="twitter:card"/><meta content="NetEase/pomelo" name="twitter:title"/><meta content="pomelo - A fast,scalable,distributed game server framework for Node.js." name="twitter:description"/><meta content="https://avatars0.githubusercontent.com/u/1460597?v=3&amp;s=400" name="twitter:image:src"/>
<meta content="GitHub" property="og:site_name"/><meta content="object" property="og:type"/><meta content="https://avatars0.githubusercontent.com/u/1460597?v=3&amp;s=400" property="og:image"/><meta content="NetEase/pomelo" property="og:title"/><meta content="https://github.com/NetEase/pomelo" property="og:url"/><meta content="pomelo - A fast,scalable,distributed game server framework for Node.js." property="og:description"/>
<meta content="https://api.github.com/_private/browser/stats" name="browser-stats-url">
<meta content="https://api.github.com/_private/browser/errors" name="browser-errors-url">
<link href="https://assets-cdn.github.com/" rel="assets">
<meta content="1000" name="pjax-timeout">
<meta content="/windows-tile.png" name="msapplication-TileImage">
<meta content="#ffffff" name="msapplication-TileColor">
<meta data-pjax-transient="" name="selected-link" value="repo_wiki">
<meta content="KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU" name="google-site-verification">
<meta content="UA-3769691-2" name="google-analytics">
<meta content="collector.githubapp.com" name="octolytics-host"/><meta content="github" name="octolytics-app-id"/><meta content="CA86616A:2F3F:6156519:5670C0F0" name="octolytics-dimension-request_id"/>
<meta content="/&lt;user-name&gt;/&lt;repo-name&gt;/wiki/show" data-pjax-transient="true" name="analytics-location"/>
<meta content="Rails, view, wiki#show" data-pjax-transient="true" name="analytics-event"/>
<meta class="js-ga-set" content="Logged Out" name="dimension1">
<meta content="github.com" name="hostname">
<meta content="" name="user-login">
<meta content="github.com" name="expected-hostname">
<link color="#4078c0" href="https://assets-cdn.github.com/pinned-octocat.svg" rel="mask-icon">
<link href="https://assets-cdn.github.com/favicon.ico" rel="icon" type="image/x-icon">
<meta content="cf4d8e85fd31b652edafe5903d96b297ffd2a3e1" name="form-nonce"/>
<link crossorigin="anonymous" href="src/350888e1495e7af27e01faa9d8291dee.css" media="all" rel="stylesheet"/>
<link crossorigin="anonymous" href="src/9fae9b7d8f0785d745a43c6465f74ae5.css" media="all" rel="stylesheet"/>
<meta content="cd9958d45e48e8e3157a320e9c346eaa" http-equiv="x-pjax-version">
<meta content="pomelo - A fast,scalable,distributed game server framework for Node.js." name="description">
<meta content="github.com/NetEase/pomelo git https://github.com/NetEase/pomelo.git" name="go-import">
<meta content="1460597" name="octolytics-dimension-user_id"/><meta content="NetEase" name="octolytics-dimension-user_login"/><meta content="5880912" name="octolytics-dimension-repository_id"/><meta content="NetEase/pomelo" name="octolytics-dimension-repository_nwo"/><meta content="true" name="octolytics-dimension-repository_public"/><meta content="false" name="octolytics-dimension-repository_is_fork"/><meta content="5880912" name="octolytics-dimension-repository_network_root_id"/><meta content="NetEase/pomelo" name="octolytics-dimension-repository_network_root_nwo"/>
<link href="https://github.com/NetEase/pomelo/commits/master.atom" rel="alternate" title="Recent Commits to pomelo:master" type="application/atom+xml">
</link></meta></meta></meta></link></link></meta></meta></meta></meta></meta></meta></meta></meta></meta></meta></link></meta></meta></meta></link></link></link></link></link></link></meta></meta></meta></meta></head><body style="padding:0 25px;"><div class="gollum-markdown-content instapaper_body" id="wiki-body">
<div class="markdown-body">
<h1>
<a aria-hidden="true" class="anchor" href="#%E6%A6%82%E8%BF%B0" id="user-content-概述"><span class="octicon octicon-link"></span></a>概述</h1>
<p>命令行工具pomelo是Pomelo框架提供的一个小工具，该工具能够帮助开发者更便捷、更有效率地进行应用开发。该工具包括的命令支持绝大多数的应用开发操作，包括创建初始项目、启动应用、停止应用、关闭应用等。用户可以通过pomelo --help命令查询相关命令及其使用说明。</p>
<h1>
<a aria-hidden="true" class="anchor" href="#%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%AE%89%E8%A3%85" id="user-content-命令行安装"><span class="octicon octicon-link"></span></a>命令行安装</h1>
<p>当使用如下命令安装Pomelo的时候，pomelo会自动安装在相应的bin目录下:</p>
<pre><code>$ npm install pomelo -g
</code></pre>
<h1>
<a aria-hidden="true" class="anchor" href="#%E5%91%BD%E4%BB%A4%E4%BB%8B%E7%BB%8D" id="user-content-命令介绍"><span class="octicon octicon-link"></span></a>命令介绍</h1>
<p>目前pomelo支持如下命令及选项:</p>
<ul>
<li>init: 创建一个新项目，该项目中包含创建pomelo应用的基本文件及pomelo应用的简单示例。</li>
<li>start: 启动应用及服务器。</li>
<li>list: 列出当前应用开启的所有服务器的信息，包括服务器Id、服务器类型、pid、堆使用情况、启动时长。</li>
<li>stop: 关闭应用及服务器或者停止指定的服务器。</li>
<li>kill: 强制关闭应用及服务器。</li>
<li>add: 运行时动态添加服务器。</li>
<li>masterha: 当启用masterha高可用的时候，用来启动master服务器的slave节点。</li>
<li>--version：列出当前使用pomelo的版本信息。</li>
<li>--help：列出所有pomelo支持的命令及使用说明。</li>
</ul>
<h2>
<a aria-hidden="true" class="anchor" href="#%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E" id="user-content-命令使用说明"><span class="octicon octicon-link"></span></a>命令使用说明</h2>
<ul>
<li>init </li>
</ul>
<p>根据给出的路径或文件名创建新项目，支持相对路径和绝对路径。默认情况下为当前路径，项目名称为当前文件夹名称,命令如下：</p>
<pre><code>pomelo init [dirname]
</code></pre>
<p>在创建新项目时，需要选择新项目使用的与客户端通信时使用的connector,1 代表 Websocket(native socket), 2 代表socket.io。当当前目录下有同名文件夹存在时，会提示是否覆盖，还是取消创建。</p>
<ul>
<li>start</li>
</ul>
<p>该命令用来启动Pomelo应用，命令格式如下:</p>
<pre><code>pomelo start [-e,--env &lt;env&gt;] [-d,--directory &lt;code directory&gt;]
             [-D,--daemon]
</code></pre>
<p>其中，-e 用来选择启动时使用的env，如production，development，stress-test等; -d 用来指定项目目录； -D 用来开启daemon模式启动，如果开启了daemon，那么进程将转入后台运行, 所有的日志将不再打印到console上，只能通过对应的日志文件查看日志。在0.7及以前的版本中，对于env的使用，没有使用-e选项，而是直接作为一个参数来使用的，这里需要注意一下。</p>
<p>用户可以在/game-server/config/servers.json中为不同的服务器中添加不同参数，这些参数是node和v8支持的参数，是用来指定和影响node及v8的行为的。例如，当我们想对某一个服务器开启调试的时候，就可以在服务器配置中，增加args配置项，并在args中配置开启调试的端口等，示例如下:</p>
<div class="highlight highlight-source-json"><pre>{<span class="pl-s"><span class="pl-pds">"</span>connector<span class="pl-pds">"</span></span>:[{<span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>connector-server-1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>host<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>127.0.0.1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>port<span class="pl-pds">"</span></span>:<span class="pl-c1">4050</span>, 
<span class="pl-s"><span class="pl-pds">"</span>clientPort<span class="pl-pds">"</span></span>:<span class="pl-c1">3050</span>, <span class="pl-s"><span class="pl-pds">"</span>args<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>--debug=[port]<span class="pl-pds">"</span></span>}]}</pre></div>
<ul>
<li>list</li>
</ul>
<p>当应用启动后，该命令列出所有服务器信息。由于当执行此操作时，pomelo是作为监控管理框架的一个客户端的，在连接注册到master上的时候，需要进行身份验证。默认生成的项目中，有一个默认的用户名admin，口令也为admin，因此在不指定用户名和口令的时候，默认使用的用户名和口令均为admin，下面的stop命令和kill命令均需要使用用户名和口令验证，默认值与此处相同。应用的管理用户可以通过修改config/adminUser.json文件进行配置,具体的配置格式可以参考pomelo init生成的项目中的相关配置。</p>
<p>执行本命令时，还需要指定master服务器的ip和port, 这样可以是的pomelo list可以在任意地方执行。pomelo stop/kill/add等也同样需要指定master服务器的ip和port，默认使用127.0.0.1:3005作为master服务器的地址。</p>
<p>命令格式如下: </p>
<pre><code> pomelo list [-u,--username &lt;username&gt;] [-p,--password &lt;password&gt;]
             [-h,--host &lt;master-host&gt;] [-P,--port &lt;master-port&gt;]
</code></pre>
<ul>
<li>stop </li>
</ul>
<p>stop用来停止当前应用，优雅地关闭应用。和kill命令不同，这种关闭首先会切断客户端与服务器的连接，然后逐一关闭所有服务器。如果指定了服务器serverId的话，则会关闭特定的服务器，而不是关闭所有的服务器。与list命令一样，需要权限验证，默认的用户名和密码均为admin,也需要指定master服务器的位置, 跟pomelo list一样，默认使用127.0.0.1:3005。</p>
<p>命令格式如下:</p>
<pre><code> pomelo stop [-u,--username &lt;username&gt;] [-p,--password &lt;password&gt;]
             [-h,--host &lt;master-host&gt;] [-P,--port &lt;master-port&gt;]
             [&lt;serverIds&gt;...]
</code></pre>
<ul>
<li>kill </li>
</ul>
<p>该命令强制关闭应用。在本地进行应用开发过程中，如果遇到kill之后还有服务器进程没有关闭的情况，可以增加--force选项，强制关闭所有服务器进程。该操作相当地暴力，可能产生数据丢失等不好的影响，可以在开发调试时使用，不推荐在线上使用该命令。该命令同样也需要进行身份验证以及指定master服务器的位置，具体方式同list和stop。</p>
<p>该命令需在项目的根目录或game-server下使用，命令格式如下:</p>
<pre><code> pomelo kill [-u,--username &lt;username&gt;] [-p,--password &lt;password&gt;]
             [-h,--host &lt;master-host&gt;] [-P,--port &lt;master-port&gt;]
             [-f,--force]
</code></pre>
<ul>
<li>add</li>
</ul>
<p>该命令用来运行时动态增加服务器，与pomelo list等命令类似，pomelo add也需要身份验证以及指定master服务器的地址。具体命令格式如下:</p>
<pre><code> pomelo add [-u,--username &lt;username&gt;] [-p,--password &lt;password&gt;]
            [-h,--host &lt;master-host&gt;] [-P,--port &lt;master-port&gt;]
            [&lt;server-args&gt;...]
</code></pre>
<p>args参数是用来指定新增服务器的参数的，包括服务器类型，服务器id等， 支持一次增加一台或多台同类型的服务器，例子如下：</p>
<pre><code> pomelo add host=127.0.0.1 port=8000++ clientPort=9000++ frontend=true clusterCount=3 serverType=connector 
 pomelo add host=127.0.0.1 port=8000 clientPort=9000 frontend=true serverType=connector id=added-connector-server
</code></pre>
<ul>
<li>masterha</li>
</ul>
<p>当启用了master服务器的高可用后，该命令用来启动master服务器的slave节点，需要在game-server/config目录下配置masterha.json。其他的命令行参数类似于pomelo start，格式如下：</p>
<pre><code>pomelo masterha [-d,--direcotry &lt;code directory&gt;]
</code></pre>
<ul>
<li>其他</li>
</ul>
<p>查看当前Pomelo的版本时，可以使用如下命令:</p>
<pre><code>pomelo --version
</code></pre>
<p>查看pomelo命令行工具的帮助时，可以使用如下命令:</p>
<pre><code>pomelo --help
pomelo add --help
pomelo start --help
</code></pre>
<ul>
<li>注:</li>
</ul>
<p>一般来说在开发环境中，master服务器的地址会一直是127.0.0.1:3005,使用的管理用户的username和password直接使用默认的admin即可，这样的话，开发调试时，在执行具体的pomelo命令的时候，maser服务器的地址信息以及管理用户信息都可以省略。</p>
</div>
</div></body></html>